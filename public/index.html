<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Sistema de Estoque do Supermercado</title>
  <link rel="stylesheet" href="/css/style.css" />
</head>
<body>
  <header>
    <div><strong>Estoque do Supermercado</strong></div>
    <nav>
      <a href="/">InÃ­cio</a>
      <a href="/conferencia-estoque">ConferÃªncia de Estoque</a>
      <a href="/conferencia-quebras">ConferÃªncia de Quebras</a>
      <a href="/conferencia-saidas">ConferÃªncia de SaÃ­das</a>
      <a href="/alterar-senha">Alterar Senha</a>
      <span id="links-admin"></span>
    </nav>
    <button onclick="logout()" style="margin-left: auto;">Sair</button>
  </header>

  <main class="container">
    <h1>Bem-vindo ao Sistema de Estoque</h1>
    <div class="card-grid" id="cards"></div>
  </main>

  <script src="/js/main.js"></script>
  <script>
    const user = JSON.parse(localStorage.getItem('usuarioLogado'));

    const cards = document.getElementById('cards');

    const criarCard = (href, texto) => {
      const div = document.createElement('div');
      div.className = 'card';
      div.innerHTML = `<a href="${href}">${texto}</a>`;
      cards.appendChild(div);
    };

    criarCard("/conferencia-estoque", "ðŸ“‹ ConferÃªncia de Estoque");
    criarCard("/conferencia-quebras", "ðŸ“‰ ConferÃªncia de Quebras");
    criarCard("/conferencia-saidas", "ðŸ“ˆ ConferÃªncia de SaÃ­das");
    criarCard("/alterar-senha", "ðŸ” Alterar Senha");

    if (user.role === 'admin') {
      criarCard("/cadastro", "ðŸ“¦ Cadastro de Produto");
      criarCard("/quebras", "âŒ Registro de Quebras");
      criarCard("/saidas", "ðŸ’° Registro de SaÃ­das");
      criarCard("/logs", "ðŸ•µï¸ Logs de Rastreio");
      criarCard("/painel-admin", "ðŸ“Š Painel Admin");
      criarCard("/admin-criar-usuario", "ðŸ‘¤ Criar Novo UsuÃ¡rio");

    }

    fetch('/api/notificacoes/baixo-estoque?limite=5')
      .then(r => r.json())
      .then(d => {
        if (d.length) {
          alert('AtenÃ§Ã£o: estoque baixo para ' + d.map(p => p.nome).join(', '));
        }
      });
  </script>
</body>
</html>
