<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Sistema de Estoque do Supermercado</title>
  <link rel="stylesheet" href="/css/style.css" />
</head>
<body>
  <header>
    <div><strong>Estoque do Supermercado</strong></div>
    <nav>
      <a href="/conferencia-estoque">ğŸ“‹ ConferÃªncia de Estoque</a>
      <a href="/conferencia-quebras">ğŸ“‰ ConferÃªncia de Quebras</a>
      <a href="/conferencia-saidas">ğŸ“ˆ ConferÃªncia de SaÃ­das</a>
      <a href="/alterar-senha">ğŸ” Alterar Senha</a>
      <span id="links-admin"></span>
    </nav>
    <button onclick="logout()" class="logout-btn">Sair</button>
  </header>

  <main>
    <h1>Bem-vindo ao Sistema de Estoque</h1>
    <div class="card-grid" id="cards"></div>
  </main>

  <script src="/js/main.js"></script>
  <script>
    const user = JSON.parse(localStorage.getItem('usuarioLogado'));

    const cards = document.getElementById('cards');
    const linksAdmin = document.getElementById('links-admin');

    const criarCard = (href, texto) => {
      const div = document.createElement('div');
      div.className = 'card';
      div.innerHTML = `<a href="${href}">${texto}</a>`;
      cards.appendChild(div);
    };

    criarCard("/conferencia-estoque", "ğŸ“‹ ConferÃªncia de Estoque");
    criarCard("/conferencia-quebras", "ğŸ“‰ ConferÃªncia de Quebras");
    criarCard("/conferencia-saidas", "ğŸ“ˆ ConferÃªncia de SaÃ­das");
    criarCard("/alterar-senha", "ğŸ” Alterar Senha");

    if (user.role === 'admin') {
    criarCard("/cadastro", "ğŸ“¦ Cadastro de Produto");
    criarCard("/quebras", "âŒ Registro de Quebras");
    criarCard("/saidas", "ğŸ’° Registro de SaÃ­das");
    criarCard("/fornecedores", "ğŸšš Fornecedores");
    criarCard("/logs", "ğŸ•µï¸ Logs de Rastreio");
    criarCard("/painel-admin", "ğŸ“Š Painel Admin");
    criarCard("/admin-criar-usuario", "ğŸ‘¤ Criar Novo UsuÃ¡rio");

      linksAdmin.innerHTML = `
        <a href="/cadastro">ğŸ“¦ Cadastro</a>
        <a href="/quebras">âŒ Quebras</a>
        <a href="/saidas">ğŸ’° SaÃ­das</a>
        <a href="/fornecedores">ğŸšš Fornecedores</a>
        <a href="/logs">ğŸ•µï¸ Logs</a>
        <a href="/painel-admin">ğŸ“Š Painel</a>
        <a href="/admin-criar-usuario">ğŸ‘¤ Novo UsuÃ¡rio</a>
      `;
    }

    fetch('/api/notificacoes/baixo-estoque?limite=5')
      .then(r => r.json())
      .then(d => {
        if (d.length) {
          alert('AtenÃ§Ã£o: estoque baixo para ' + d.map(p => p.nome).join(', '));
        }
      });
  </script>
</body>
</html>
